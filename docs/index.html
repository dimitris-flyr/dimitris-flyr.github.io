<html>
    <head>
        <style>
            body {
                max-width: 1350px;
                margin: 0 auto;
                padding: 10px;
            }
            table, th, td {
                border: 1px solid;
            }
        </style>
    </head>
<body>
    <h1>My bookmarklets</h1>
    <table>
        <thead>
            <tr>
                <th>
                    Bookmarklet
                </th>
                <th colspan="2">
                    Description
                </th>
            </tr>
        </thead>
        <tbody>
        <script>
            function loadBookmarket(fileName, description) {
                const href = `javascript:
                    (d => {
                    const s = d.createElement('script');
                    s.src='${window.location.href}dist/js/${fileName}.js?cachebust='+Date.now();
                    s.type='text/javascript';
                    d.head.appendChild(s);
                    })(document)
                `.replace(/\n\s+/g, '');
                document.write(`<tr><td><a href="${href}">${fileName}</a></td><td colspan="2"> ${description}</td></tr>`)
            }
            
            // We can't inject a script on GitHub, therefore we run it inline
            function loadToEphEnvBookmarklet() {
                const toEphEnv = `javascript:(() => {
                    const prPathnameMatches = window.location.pathname.match(/pull\\/(\\d+)/);
                    const prID = prPathnameMatches ? prPathnameMatches[1] : null;
                    if (!prID) {
                        console.warn('No PR ID found in this page');
                        return;
                    }
                    window.location.href = \`https://\${prID}-n4.cirrus.ai/ancillaries/\`;
                })();`;
                
                document.write(`<tr><td><a href="${toEphEnv}">to-eph-env</a></td><td colspan="2"> To ephimeral environment from PR</td></tr>`)
            }


            loadBookmarket("jira", "Jira")
            loadToEphEnvBookmarklet()
        </script>
        </tbody>
    </table>
</body>
</html>